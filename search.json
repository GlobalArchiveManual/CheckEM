[{"path":[]},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/check-fish.html","id":"load-the-necessary-libraries","dir":"Articles > R-workflows","previous_headings":"R set up","what":"Load the necessary libraries","title":"Checking fish data exported from EventMeasure","text":"","code":"library(devtools) library(CheckEM) library(tidyverse) library(googlesheets4) library(sf) library(terra) library(here)"},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/check-fish.html","id":"set-the-study-name","dir":"Articles > R-workflows","previous_headings":"R set up","what":"Set the study name","title":"Checking fish data exported from EventMeasure","text":"","code":"name <- \"example-bruv-workflow\""},{"path":[]},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/check-fish.html","id":"load-and-tidy-the-metadata--if-you-have-already-completed-this-step-while-checking-your-habitat-data-then-you-can-skip-these-next-two-chunks-of-code-and-simply-read-in-the-metadata-see-below-","dir":"Articles > R-workflows","previous_headings":"Read in and format the metadata","what":"Load and tidy the metadata. If you have already completed this step while checking your habitat data, then you can skip these next two chunks of code and simply read in the metadata (see below).","title":"Checking fish data exported from EventMeasure","text":"","code":"metadata <- read_metadata(here::here(\"r-workflows/data/raw/\")) %>%   dplyr::select(campaignid, sample, longitude_dd, latitude_dd, date_time, location, site, depth, successful_count, successful_length, successful_habitat_forward, successful_habitat_backward) %>%   glimpse() ## Rows: 32 ## Columns: 12 ## $ campaignid                  <chr> \"2023-03_SwC_stereo-BRUVs\", \"2023-03_SwC_s… ## $ sample                      <chr> \"35\", \"5\", \"26\", \"23\", \"29\", \"4\", \"32\", \"3… ## $ longitude_dd                <chr> \"114.923645\", \"114.9292367\", \"114.92843\", … ## $ latitude_dd                 <chr> \"-34.13155\", \"-34.12952667\", \"-34.12729\", … ## $ date_time                   <chr> \"14/03/2023 23:36\", \"14/03/2023 23:49\", \"1… ## $ location                    <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… ## $ site                        <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… ## $ depth                       <chr> \"39.6\", \"42.7\", \"36\", \"41\", \"42.6\", \"45\", … ## $ successful_count            <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", … ## $ successful_length           <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", … ## $ successful_habitat_forward  <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", … ## $ successful_habitat_backward <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", …"},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/check-fish.html","id":"save-the-metadata-as-an-r-data-file-this-creates-a-lighter-file-than-saving-as-a--csv-or-similar","dir":"Articles > R-workflows","previous_headings":"Read in and format the metadata","what":"Save the metadata as an R data file (this creates a lighter file than saving as a .csv or similar)","title":"Checking fish data exported from EventMeasure","text":"","code":"saveRDS(metadata, file = here::here(paste0(\"r-workflows/data/tidy/\",                                 name, \"_Metadata.rds\")))"},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/check-fish.html","id":"load-metadata-if-you-have-already-exported-in-the-check-habitat-scripts--if-you-have-just-loaded-and-saved-the-metadata-then-you-can-skip-this-chunk-of-code-","dir":"Articles > R-workflows","previous_headings":"Read in and format the metadata","what":"Load metadata if you have already exported in the ‘check-habitat’ scripts. If you have just loaded and saved the metadata, then you can skip this chunk of code.","title":"Checking fish data exported from EventMeasure","text":"","code":"metadata <- readRDS(here::here(paste0(\"r-workflows/data/tidy/\",                                 name, \"_Metadata.rds\")))"},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/check-fish.html","id":"load-marine-park-shapefiles-and-extract-fishing-status-e-g--fished-or-no-take-for-use-in-modelling","dir":"Articles > R-workflows","previous_headings":"Read in and format the metadata","what":"Load marine park shapefiles, and extract fishing status (e.g. ‘Fished’ or ‘No-take’) for use in modelling","title":"Checking fish data exported from EventMeasure","text":"","code":"marine.parks <- st_read(here::here(\"r-workflows/data/spatial/shapefiles/Collaborative_Australian_Protected_Areas_Database_(CAPAD)_2022_-_Marine.shp\"))  %>%   dplyr::select(geometry, ZONE_TYPE) %>%   st_transform(4326) %>%   st_make_valid() ## Reading layer `Collaborative_Australian_Protected_Areas_Database_(CAPAD)_2022_-_Marine' from data source `/home/runner/work/CheckEM/CheckEM/r-workflows/data/spatial/shapefiles/Collaborative_Australian_Protected_Areas_Database_(CAPAD)_2022_-_Marine.shp'  ##   using driver `ESRI Shapefile' ## Simple feature collection with 3775 features and 26 fields ## Geometry type: MULTIPOLYGON ## Dimension:     XY ## Bounding box:  xmin: 70.71702 ymin: -58.44947 xmax: 170.3667 ymax: -8.473407 ## Geodetic CRS:  WGS 84 metadata_sf <- st_as_sf(metadata, coords = c(\"longitude_dd\", \"latitude_dd\"),                       crs = 4326)  metadata <- metadata_sf %>%   st_intersection(marine.parks) %>%   bind_cols(st_coordinates(.)) %>%   as.data.frame() %>%   dplyr::select(-c(geometry)) %>%   dplyr::rename(longitude_dd = X, latitude_dd = Y) %>%   dplyr::mutate(status = if_else(str_detect(ZONE_TYPE, \"National|Sanctuary\"),                                 \"No-take\", \"Fished\")) %>%   clean_names() %>%   glimpse() ## Warning: attribute variables are assumed to be spatially constant throughout ## all geometries ## Rows: 32 ## Columns: 14 ## $ campaignid                  <chr> \"2023-03_SwC_stereo-BRUVs\", \"2023-03_SwC_s… ## $ sample                      <chr> \"35\", \"5\", \"26\", \"23\", \"29\", \"4\", \"32\", \"3… ## $ date_time                   <chr> \"14/03/2023 23:36\", \"14/03/2023 23:49\", \"1… ## $ location                    <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… ## $ site                        <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… ## $ depth                       <chr> \"39.6\", \"42.7\", \"36\", \"41\", \"42.6\", \"45\", … ## $ successful_count            <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", … ## $ successful_length           <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", … ## $ successful_habitat_forward  <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", … ## $ successful_habitat_backward <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", … ## $ zone_type                   <chr> \"National Park Zone (IUCN II)\", \"National … ## $ longitude_dd                <dbl> 114.9236, 114.9292, 114.9284, 114.9190, 11… ## $ latitude_dd                 <dbl> -34.13155, -34.12953, -34.12729, -34.12832… ## $ status                      <chr> \"No-take\", \"No-take\", \"No-take\", \"No-take\"…"},{"path":[]},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/check-fish.html","id":"load-the-count-data-maxn-from-_points-txt-file","dir":"Articles > R-workflows","previous_headings":"Read in the raw data","what":"Load the count data (MaxN from _Points.txt file)","title":"Checking fish data exported from EventMeasure","text":"","code":"points <- CheckEM::read_files_maxn(here::here(\"r-workflows/data/raw/\")) %>%   glimpse() ## Rows: 17,425 ## Columns: 22 ## $ sample      <chr> \"10\", \"10\", \"10\", \"10\", \"10\", \"10\", \"10\", \"10\", \"10\", \"10\"… ## $ pointindex  <chr> \"0\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"1… ## $ filename    <chr> \"Left_MAH00355.MP4\", \"Left_MAH00355.MP4\", \"Left_MAH00355.M… ## $ frame       <chr> \"11347\", \"11403\", \"11403\", \"11473\", \"11473\", \"11473\", \"127… ## $ time        <chr> \"25.71152\", \"25.72709\", \"25.72709\", \"25.74655\", \"25.74655\"… ## $ period      <chr> \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\"… ## $ periodtime  <chr> \"0.33422\", \"0.34979\", \"0.34979\", \"0.36926\", \"0.36926\", \"0.… ## $ imagecol    <chr> \"463.20000\", \"474.00000\", \"1495.20000\", \"1562.40000\", \"157… ## $ imagerow    <chr> \"669.60000\", \"655.20000\", \"541.20000\", \"543.60000\", \"571.2… ## $ rectwidth   <chr> \"0.00000\", \"0.00000\", \"0.00000\", \"0.00000\", \"0.00000\", \"0.… ## $ rectheight  <chr> \"0.00000\", \"0.00000\", \"0.00000\", \"0.00000\", \"0.00000\", \"0.… ## $ family      <chr> \"Labridae\", \"Labridae\", \"Labridae\", \"Labridae\", \"Labridae\"… ## $ genus       <chr> \"Ophthalmolepis\", \"Ophthalmolepis\", \"Ophthalmolepis\", \"Pse… ## $ species     <chr> \"lineolata\", \"lineolata\", \"lineolata\", \"biserialis\", \"bise… ## $ code        <chr> \"37384040\", \"37384040\", \"37384040\", \"37384149\", \"37384149\"… ## $ number      <chr> \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\"… ## $ stage       <chr> \"AD\", \"AD\", \"AD\", \"AD\", \"AD\", \"AD\", \"AD\", \"AD\", \"AD\", \"AD\"… ## $ activity    <chr> \"Passing\", \"Passing\", \"Passing\", \"Passing\", \"Passing\", \"Pa… ## $ comment     <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… ## $ attribute9  <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… ## $ attribute10 <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… ## $ campaignid  <chr> \"2023-03_SwC_stereo-BRUVs\", \"2023-03_SwC_stereo-BRUVs\", \"2…"},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/check-fish.html","id":"create-and-tidy-the-maxn-file","dir":"Articles > R-workflows","previous_headings":"Read in the raw data","what":"Create and tidy the MaxN file","title":"Checking fish data exported from EventMeasure","text":"","code":"maxn <- points %>%    dplyr::group_by(campaignid, sample, filename, periodtime, frame, family, genus, species) %>%    dplyr::mutate(number = as.numeric(number)) %>%   dplyr::summarise(maxn = sum(number)) %>%   dplyr::group_by(campaignid, sample, family, genus, species) %>%   dplyr::slice(which.max(maxn)) %>%   dplyr::ungroup() %>%   dplyr::filter(!is.na(maxn)) %>%   dplyr::select(-frame) %>%   tidyr::replace_na(list(maxn = 0)) %>%   dplyr::mutate(maxn = as.numeric(maxn)) %>%   dplyr::filter(maxn > 0) %>%   dplyr::inner_join(metadata) %>%   dplyr::filter(successful_count %in% c(\"Yes\")) %>%    dplyr::filter(maxn > 0) %>%   glimpse() ## `summarise()` has grouped output by 'campaignid', 'sample', 'filename', ## 'periodtime', 'frame', 'family', 'genus'. You can override using the `.groups` ## argument. ## Joining with `by = join_by(campaignid, sample)` ## Rows: 462 ## Columns: 20 ## $ campaignid                  <chr> \"2023-03_SwC_stereo-BRUVs\", \"2023-03_SwC_s… ## $ sample                      <chr> \"10\", \"10\", \"10\", \"10\", \"10\", \"10\", \"10\", … ## $ filename                    <chr> \"Left_MAH00356.MP4\", \"Left_MAH00356.MP4\", … ## $ periodtime                  <chr> \"20.35283\", \"23.92279\", \"55.15232\", \"15.42… ## $ family                      <chr> \"Dasyatidae\", \"Gerreidae\", \"Heterodontidae… ## $ genus                       <chr> \"Dasyatis\", \"Parequula\", \"Heterodontus\", \"… ## $ species                     <chr> \"brevicaudata\", \"melbournensis\", \"portusja… ## $ maxn                        <dbl> 1, 1, 1, 1, 71, 9, 8, 1, 5, 2, 9, 1, 1, 2,… ## $ date_time                   <chr> \"18/03/2023 2:44\", \"18/03/2023 2:44\", \"18/… ## $ location                    <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… ## $ site                        <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… ## $ depth                       <chr> \"44.3\", \"44.3\", \"44.3\", \"44.3\", \"44.3\", \"4… ## $ successful_count            <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", … ## $ successful_length           <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", … ## $ successful_habitat_forward  <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", … ## $ successful_habitat_backward <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", … ## $ zone_type                   <chr> \"National Park Zone (IUCN II)\", \"National … ## $ longitude_dd                <dbl> 114.8533, 114.8533, 114.8533, 114.8533, 11… ## $ latitude_dd                 <dbl> -34.08388, -34.08388, -34.08388, -34.08388… ## $ status                      <chr> \"No-take\", \"No-take\", \"No-take\", \"No-take\"…"},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/check-fish.html","id":"load-the-length-data-from-_lengths-txt-and-_3dpoints-txt","dir":"Articles > R-workflows","previous_headings":"Read in the raw data","what":"Load the length data (from ’_Lengths.txt’ and ’_3DPoints.txt’)","title":"Checking fish data exported from EventMeasure","text":"","code":"length3dpoints <- read_files_length(here::here(\"r-workflows/data/raw/\")) %>%                      dplyr::select(-c(comment))%>%   dplyr::inner_join(metadata)%>%   dplyr::filter(successful_length %in% \"Yes\") %>%   glimpse() ## Joining with `by = join_by(sample, campaignid)` ## Rows: 2,428 ## Columns: 47 ## $ sample                      <chr> \"10\", \"10\", \"10\", \"10\", \"10\", \"12\", \"12\", … ## $ imageptpair                 <chr> \"72\", \"73\", \"75\", \"81\", \"93\", \"0\", \"11\", \"… ## $ filenameleft                <chr> \"Left_MAH00355.MP4\", \"Left_MAH00355.MP4\", … ## $ frameleft                   <chr> \"65608\", \"74525\", \"21436\", \"33446\", \"46833… ## $ filenameright               <chr> \"Right_MAH00344.MP4\", \"Right_MAH00344.MP4\"… ## $ frameright                  <chr> \"64140\", \"73057\", \"20028\", \"32038\", \"45425… ## $ time                        <chr> \"40.79909\", \"43.27851\", \"51.07269\", \"54.41… ## $ period                      <chr> \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1… ## $ periodtime                  <chr> \"15.42180\", \"17.90122\", \"25.69539\", \"29.03… ## $ x                           <chr> \"-430.67367\", \"-278.33750\", \"-997.34125\", … ## $ y                           <chr> \"-140.98709\", \"-257.03677\", \"-186.86483\", … ## $ z                           <chr> \"-868.53490\", \"-762.92425\", \"-1522.45323\",… ## $ sx                          <chr> \"0.64880\", \"0.48001\", \"1.91708\", \"0.42177\"… ## $ sy                          <chr> \"0.46100\", \"0.47613\", \"0.79836\", \"0.44960\"… ## $ sz                          <chr> \"1.11439\", \"0.88751\", \"3.13793\", \"0.83996\"… ## $ rms                         <chr> \"0.67020\", \"0.47105\", \"0.63932\", \"0.10770\"… ## $ range                       <chr> \"979.64791\", \"851.81752\", \"1829.60976\", \"7… ## $ direction                   <chr> \"27.65589\", \"26.62953\", \"33.74391\", \"22.82… ## $ family                      <chr> \"Labridae\", \"Urolophidae\", \"Labridae\", \"Tr… ## $ genus                       <chr> \"Austrolabrus\", \"Trygonoptera\", \"Ophthalmo… ## $ species                     <chr> \"maculatus\", \"ovalis\", \"lineolata\", \"dumer… ## $ code                        <chr> \"37384025\", \"37038016\", \"37384040\", \"37027… ## $ number                      <chr> \"1\", \"1\", \"1\", \"1\", \"1\", \"40\", \"1\", \"1\", \"… ## $ stage                       <chr> \"AD\", \"AD\", \"AD\", \"AD\", \"AD\", \"AD\", \"AD\", … ## $ activity                    <chr> \"Passing\", \"Passing\", \"Passing\", \"Passing\"… ## $ attribute9                  <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… ## $ attribute10                 <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… ## $ campaignid                  <chr> \"2023-03_SwC_stereo-BRUVs\", \"2023-03_SwC_s… ## $ length                      <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… ## $ precision                   <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… ## $ horzdir                     <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… ## $ vertdir                     <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… ## $ midx                        <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… ## $ midy                        <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… ## $ midz                        <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… ## $ date_time                   <chr> \"18/03/2023 2:44\", \"18/03/2023 2:44\", \"18/… ## $ location                    <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… ## $ site                        <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… ## $ depth                       <chr> \"44.3\", \"44.3\", \"44.3\", \"44.3\", \"44.3\", \"4… ## $ successful_count            <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", … ## $ successful_length           <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", … ## $ successful_habitat_forward  <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", … ## $ successful_habitat_backward <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", … ## $ zone_type                   <chr> \"National Park Zone (IUCN II)\", \"National … ## $ longitude_dd                <dbl> 114.8533, 114.8533, 114.8533, 114.8533, 11… ## $ latitude_dd                 <dbl> -34.08388, -34.08388, -34.08388, -34.08388… ## $ status                      <chr> \"No-take\", \"No-take\", \"No-take\", \"No-take\"…"},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/check-fish.html","id":"tidy-and-complete-maxn-data-e-g--complete-zeroes-in-the-data","dir":"Articles > R-workflows","previous_headings":"Read in the raw data","what":"Tidy and complete MaxN data (e.g. complete zeroes in the data)","title":"Checking fish data exported from EventMeasure","text":"","code":"dat <- maxn %>%   dplyr::select(campaignid, sample, family, genus, species, maxn) %>%   tidyr::complete(nesting(campaignid, sample), nesting(family, genus, species)) %>%   replace_na(list(maxn = 0)) %>%   group_by(sample, family, genus, species) %>%   dplyr::summarise(maxn = sum(maxn)) %>%   ungroup() %>%    mutate(scientific = paste(family, genus, species, sep = \" \"))%>%   dplyr::select(sample, scientific, maxn)%>%   spread(scientific, maxn, fill = 0)%>%   glimpse() ## `summarise()` has grouped output by 'sample', 'family', 'genus'. You can ## override using the `.groups` argument. ## Rows: 32 ## Columns: 93 ## $ sample                                        <chr> \"10\", \"12\", \"14\", \"15\", … ## $ `Aplodactylidae Aplodactylus westralis`       <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Arripidae Arripis georgianus`                <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Aulopidae Latropiscis purpurissatus`         <dbl> 0, 0, 0, 0, 0, 0, 2, 0, … ## $ `Carangidae NA NA`                            <dbl> 0, 0, 0, 0, 3, 0, 0, 0, … ## $ `Carangidae Pseudocaranx sp`                  <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Carangidae Pseudocaranx spp`                 <dbl> 0, 2, 0, 0, 0, 0, 0, 39,… ## $ `Carangidae Seriola hippos`                   <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Carangidae Seriola lalandi`                  <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Carcharhinidae Carcharhinus brevipinna`      <dbl> 0, 0, 0, 0, 0, 1, 0, 0, … ## $ `Carcharhinidae Carcharhinus spp`             <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Chaetodontidae Chelmonops curiosus`          <dbl> 0, 0, 0, 0, 0, 0, 1, 0, … ## $ `Cheilodactylidae Dactylophora nigricans`     <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Cheilodactylidae Nemadactylus valenciennesi` <dbl> 0, 0, 0, 0, 0, 1, 2, 0, … ## $ `Dasyatidae Dasyatis brevicaudata`            <dbl> 1, 0, 0, 0, 0, 0, 0, 0, … ## $ `Enoplosidae Enoplosus armatus`               <dbl> 0, 0, 1, 0, 0, 0, 0, 0, … ## $ `Gerreidae Parequula melbournensis`           <dbl> 1, 2, 0, 1, 1, 0, 0, 0, … ## $ `Glaucosomatidae Glaucosoma hebraicum`        <dbl> 0, 0, 0, 0, 0, 1, 0, 0, … ## $ `Gobiesocidae NA NA`                          <dbl> 0, 0, 0, 0, 0, 0, 0, 1, … ## $ `Gobiesocidae NA spp`                         <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Heterodontidae Heterodontus portusjacksoni`  <dbl> 1, 0, 0, 0, 0, 1, 0, 0, … ## $ `Kyphosidae Girella tephraeops`               <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Labridae Achoerodus gouldii`                 <dbl> 0, 0, 0, 0, 0, 0, 0, 1, … ## $ `Labridae Austrolabrus maculatus`             <dbl> 1, 1, 1, 1, 0, 2, 0, 0, … ## $ `Labridae Bodianus frenchii`                  <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Labridae Choerodon rubescens`                <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Labridae Coris auricularis`                  <dbl> 71, 5, 155, 72, 30, 43, … ## $ `Labridae Eupetrichthys angustipes`           <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Labridae NA NA`                              <dbl> 0, 0, 0, 0, 0, 1, 0, 0, … ## $ `Labridae NA sp1`                             <dbl> 0, 0, 0, 0, 0, 0, 3, 0, … ## $ `Labridae Notolabrus parilus`                 <dbl> 0, 0, 0, 0, 0, 1, 0, 0, … ## $ `Labridae Ophthalmolepis lineolata`           <dbl> 9, 12, 13, 16, 10, 11, 0… ## $ `Labridae Ophthalmolepis lineolatus`          <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Labridae Pseudolabrus biserialis`            <dbl> 8, 3, 5, 8, 8, 12, 0, 15… ## $ `Labridae Suezichthys bifurcatus`             <dbl> 0, 0, 0, 0, 0, 0, 3, 0, … ## $ `Labridae Suezichthys cyanolaemus`            <dbl> 0, 0, 0, 0, 0, 0, 1, 0, … ## $ `Monacanthidae Acanthaluteres vittiger`       <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Monacanthidae Meuschenia flavolineata`       <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Monacanthidae Meuschenia freycineti`         <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Monacanthidae Meuschenia galii`              <dbl> 1, 1, 0, 0, 1, 1, 0, 0, … ## $ `Monacanthidae Meuschenia hippocrepis`        <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Monacanthidae Meuschenia scaber`             <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Monacanthidae Meuschenia spp`                <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Monacanthidae Meuschenia venusta`            <dbl> 0, 0, 0, 1, 0, 0, 0, 1, … ## $ `Monacanthidae NA spp`                        <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Monacanthidae Scobinichthys granulatus`      <dbl> 0, 1, 0, 0, 0, 0, 0, 0, … ## $ `Mullidae Parupeneus chrysopleuron`           <dbl> 0, 0, 0, 0, 0, 0, 1, 0, … ## $ `Mullidae Upeneichthys vlamingii`             <dbl> 0, 0, 1, 0, 0, 1, 0, 0, … ## $ `Muraenidae Gymnothorax prasinus`             <dbl> 0, 0, 0, 1, 1, 0, 0, 0, … ## $ `Muraenidae Gymnothorax woodwardi`            <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `NA NA spp`                                   <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Neosebastidae Neosebastes bougainvillii`     <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Neosebastidae Neosebastes nigropunctatus`    <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Neosebastidae Neosebastes pandus`            <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Odacidae Siphonognathus caninis`             <dbl> 0, 1, 0, 0, 0, 0, 0, 0, … ## $ `Odacidae Siphonognathus spp`                 <dbl> 0, 0, 0, 1, 0, 0, 0, 0, … ## $ `Odontaspididae Furgaleus macki`              <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Oplegnathidae Oplegnathus woodwardi`         <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Orectolobidae Orectolobus spp`               <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Ostraciidae Anoplocapros lenticularis`       <dbl> 0, 0, 0, 1, 1, 0, 1, 0, … ## $ `Parascylliidae Parascyllium variolatum`      <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Pempherididae Parapriacanthus elongatus`     <dbl> 0, 0, 0, 0, 0, 0, 0, 58,… ## $ `Pempherididae Pempheris klunzingeri`         <dbl> 0, 0, 0, 0, 6, 0, 0, 85,… ## $ `Platycephalidae Platycephalus speculator`    <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Platycephalidae Platycephalus spp`           <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Plesiopidae Trachinops noarlungae`           <dbl> 0, 0, 0, 0, 0, 215, 0, 0… ## $ `Pomacentridae Chromis klunzingeri`           <dbl> 5, 15, 7, 24, 12, 1, 0, … ## $ `Pomacentridae Chromis westaustralis`         <dbl> 2, 0, 0, 1, 0, 9, 0, 0, … ## $ `Pomacentridae Parma mccullochi`              <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Pomacentridae Parma occidentalis`            <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Pomacentridae Parma spp`                     <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Scombridae Thunnus spp`                      <dbl> 0, 0, 0, 0, 1, 0, 0, 2, … ## $ `Scorpididae Neatypus obliquus`               <dbl> 9, 8, 7, 13, 23, 9, 2, 1… ## $ `Scorpididae Scorpis aequipinnis`             <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Scorpididae Scorpis georgiana`               <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Scorpididae Tilodon sexfasciatus`            <dbl> 0, 1, 0, 0, 0, 0, 0, 0, … ## $ `Scyliorhinidae Aulohalaelurus labiosus`      <dbl> 0, 1, 0, 0, 0, 0, 0, 0, … ## $ `Serranidae Caesioperca rasor`                <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Serranidae Caesioperca sp`                   <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Serranidae Caesioperca sp1`                  <dbl> 0, 0, 0, 2, 0, 0, 2, 0, … ## $ `Serranidae Epinephelides armatus`            <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Serranidae Hypoplectrodes nigroruber`        <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Serranidae Othos dentex`                     <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Sparidae Chrysophrys auratus`                <dbl> 0, 0, 0, 1, 0, 0, 8, 0, … ## $ `Sphyraenidae Sphyraena novaehollandiae`      <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `SUS SUS SUS`                                 <dbl> 0, 40, 0, 0, 0, 0, 11, 0… ## $ `Tetraodontidae Lagocephalus sceleratus`      <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Triakidae Furgaleus macki`                   <dbl> 0, 0, 1, 2, 1, 1, 1, 0, … ## $ `Triakidae Mustelus antarcticus`              <dbl> 0, 0, 0, 0, 0, 0, 0, 1, … ## $ `Triglidae Chelidonichthys kumu`              <dbl> 0, 0, 0, 0, 0, 0, 0, 0, … ## $ `Trygonorrhinidae Trygonorrhina dumerilii`    <dbl> 1, 0, 0, 0, 0, 1, 0, 1, … ## $ `Unknown Unknown Unknown`                     <dbl> 0, 0, 0, 0, 0, 0, 1, 0, … ## $ `Urolophidae Trygonoptera ovalis`             <dbl> 1, 1, 0, 1, 1, 0, 0, 0, … maxn.families <- maxn %>%   dplyr::mutate(scientific = paste(family, genus, species, sep = \" \")) %>%   filter(!(family %in% \"Unknown\")) %>%   dplyr::select(c(family, genus, species, scientific)) %>%   distinct() %>%   glimpse() ## Rows: 91 ## Columns: 4 ## $ family     <chr> \"Dasyatidae\", \"Gerreidae\", \"Heterodontidae\", \"Labridae\", \"L… ## $ genus      <chr> \"Dasyatis\", \"Parequula\", \"Heterodontus\", \"Austrolabrus\", \"C… ## $ species    <chr> \"brevicaudata\", \"melbournensis\", \"portusjacksoni\", \"maculat… ## $ scientific <chr> \"Dasyatidae Dasyatis brevicaudata\", \"Gerreidae Parequula me… complete.maxn <- dat %>%   pivot_longer(names_to = \"scientific\", values_to = \"maxn\",                cols = 2:ncol(.)) %>%   inner_join(maxn.families, by = c(\"scientific\")) %>%   full_join(metadata)%>%   glimpse() ## Joining with `by = join_by(sample)` ## Rows: 2,912 ## Columns: 19 ## $ sample                      <chr> \"10\", \"10\", \"10\", \"10\", \"10\", \"10\", \"10\", … ## $ scientific                  <chr> \"Aplodactylidae Aplodactylus westralis\", \"… ## $ maxn                        <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, … ## $ family                      <chr> \"Aplodactylidae\", \"Arripidae\", \"Aulopidae\"… ## $ genus                       <chr> \"Aplodactylus\", \"Arripis\", \"Latropiscis\", … ## $ species                     <chr> \"westralis\", \"georgianus\", \"purpurissatus\"… ## $ campaignid                  <chr> \"2023-03_SwC_stereo-BRUVs\", \"2023-03_SwC_s… ## $ date_time                   <chr> \"18/03/2023 2:44\", \"18/03/2023 2:44\", \"18/… ## $ location                    <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… ## $ site                        <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… ## $ depth                       <chr> \"44.3\", \"44.3\", \"44.3\", \"44.3\", \"44.3\", \"4… ## $ successful_count            <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", … ## $ successful_length           <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", … ## $ successful_habitat_forward  <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", … ## $ successful_habitat_backward <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", … ## $ zone_type                   <chr> \"National Park Zone (IUCN II)\", \"National … ## $ longitude_dd                <dbl> 114.8533, 114.8533, 114.8533, 114.8533, 11… ## $ latitude_dd                 <dbl> -34.08388, -34.08388, -34.08388, -34.08388… ## $ status                      <chr> \"No-take\", \"No-take\", \"No-take\", \"No-take\"…"},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/check-fish.html","id":"tidy-and-complete-length-data-e-g--complete-zeroes-in-the-data","dir":"Articles > R-workflows","previous_headings":"Read in the raw data","what":"Tidy and complete length data (e.g. complete zeroes in the data)","title":"Checking fish data exported from EventMeasure","text":"","code":"complete.length.number <- length3dpoints %>%    dplyr::filter(!family %in% \"Unknown\")%>%   dplyr::right_join(metadata) %>%   dplyr::filter(successful_length %in% \"Yes\") %>%   dplyr::select(campaignid, sample, family, genus, species, length, number, range) %>%   tidyr::complete(nesting(campaignid, sample), nesting(family, genus, species)) %>%   dplyr::mutate(number = as.numeric(number)) %>%   replace_na(list(number = 0)) %>%   ungroup() %>%   dplyr::filter(!is.na(number)) %>%   dplyr::mutate(length = as.numeric(length)) %>%   left_join(.,metadata) %>%   tidyr::uncount(number) %>%   glimpse() ## Joining with `by = join_by(sample, campaignid, date_time, location, site, ## depth, successful_count, successful_length, successful_habitat_forward, ## successful_habitat_backward, zone_type, longitude_dd, latitude_dd, status)` ## Joining with `by = join_by(campaignid, sample)` ## Rows: 4,212 ## Columns: 19 ## $ campaignid                  <chr> \"2023-03_SwC_stereo-BRUVs\", \"2023-03_SwC_s… ## $ sample                      <chr> \"10\", \"10\", \"10\", \"10\", \"10\", \"10\", \"10\", … ## $ family                      <chr> \"Dasyatidae\", \"Gerreidae\", \"Heterodontidae… ## $ genus                       <chr> \"Dasyatis\", \"Parequula\", \"Heterodontus\", \"… ## $ species                     <chr> \"brevicaudata\", \"melbournensis\", \"portusja… ## $ length                      <dbl> 1076.08643, 71.45003, NA, NA, 86.76808, 14… ## $ range                       <chr> \"2463.40578\", \"594.55232\", \"952.35412\", \"9… ## $ date_time                   <chr> \"18/03/2023 2:44\", \"18/03/2023 2:44\", \"18/… ## $ location                    <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… ## $ site                        <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… ## $ depth                       <chr> \"44.3\", \"44.3\", \"44.3\", \"44.3\", \"44.3\", \"4… ## $ successful_count            <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", … ## $ successful_length           <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", … ## $ successful_habitat_forward  <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", … ## $ successful_habitat_backward <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", … ## $ zone_type                   <chr> \"National Park Zone (IUCN II)\", \"National … ## $ longitude_dd                <dbl> 114.8533, 114.8533, 114.8533, 114.8533, 11… ## $ latitude_dd                 <dbl> -34.08388, -34.08388, -34.08388, -34.08388… ## $ status                      <chr> \"No-take\", \"No-take\", \"No-take\", \"No-take\"…"},{"path":[]},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/check-fish.html","id":"save-maxn-as-an-r-data-file","dir":"Articles > R-workflows","previous_headings":"Save the checked data","what":"Save MaxN as an R data file","title":"Checking fish data exported from EventMeasure","text":"","code":"saveRDS(complete.maxn,            file = here::here(paste0(\"r-workflows/data/staging/\",                        name, \"_complete-maxn.rds\")))"},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/check-fish.html","id":"save-lengths-as-an-r-data-file","dir":"Articles > R-workflows","previous_headings":"Save the checked data","what":"Save lengths as an R data file","title":"Checking fish data exported from EventMeasure","text":"","code":"saveRDS(complete.length.number,            file = here::here(paste0(\"r-workflows/data/staging/\",                        name, \"_complete-length.rds\")))"},{"path":[]},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/check-habitat.html","id":"load-the-necessary-libraries","dir":"Articles > R-workflows","previous_headings":"R set up","what":"Load the necessary libraries","title":"Checking habitat data exported from TransectMeasure","text":"","code":"library(devtools) library(CheckEM) library(tidyverse) library(ggplot2) library(ggbeeswarm) library(leaflet) library(leaflet.minicharts) library(RColorBrewer) library(here) library(tidyverse)"},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/check-habitat.html","id":"set-the-study-name","dir":"Articles > R-workflows","previous_headings":"R set up","what":"Set the study name","title":"Checking habitat data exported from TransectMeasure","text":"","code":"name <- \"example-bruv-workflow\""},{"path":[]},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/check-habitat.html","id":"load-and-format-the-metadata","dir":"Articles > R-workflows","previous_headings":"Read in the data","what":"Load and format the metadata","title":"Checking habitat data exported from TransectMeasure","text":"","code":"metadata <- read_metadata(here::here(\"r-workflows/data/raw/\")) %>%     dplyr::select(campaignid, sample, longitude_dd, latitude_dd, date_time, location, site, depth, successful_count, successful_length, successful_habitat_forward, successful_habitat_backward) %>%   glimpse() ## Rows: 32 ## Columns: 12 ## $ campaignid                  <chr> \"2023-03_SwC_stereo-BRUVs\", \"2023-03_SwC_s… ## $ sample                      <chr> \"35\", \"5\", \"26\", \"23\", \"29\", \"4\", \"32\", \"3… ## $ longitude_dd                <chr> \"114.923645\", \"114.9292367\", \"114.92843\", … ## $ latitude_dd                 <chr> \"-34.13155\", \"-34.12952667\", \"-34.12729\", … ## $ date_time                   <chr> \"14/03/2023 23:36\", \"14/03/2023 23:49\", \"1… ## $ location                    <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… ## $ site                        <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… ## $ depth                       <chr> \"39.6\", \"42.7\", \"36\", \"41\", \"42.6\", \"45\", … ## $ successful_count            <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", … ## $ successful_length           <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", … ## $ successful_habitat_forward  <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", … ## $ successful_habitat_backward <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", …"},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/check-habitat.html","id":"save-the-metadata-as-an-r-data-file-this-creates-a-lighter-file-than-saving-as-a--csv-or-similar","dir":"Articles > R-workflows","previous_headings":"Read in the data","what":"Save the metadata as an R data file (this creates a lighter file than saving as a .csv or similar)","title":"Checking habitat data exported from TransectMeasure","text":"","code":"saveRDS(metadata, file = here::here(paste0(\"r-workflows/data/tidy/\", name, \"_Metadata.rds\")))"},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/check-habitat.html","id":"read-in-the-points-data-exported-from-transect-measure-and-then-filter-this-into-2-dataframes-for-relief-and-habitat-annotations","dir":"Articles > R-workflows","previous_headings":"Read in the data","what":"Read in the points data exported from Transect Measure, and then filter this into 2 dataframes for relief and habitat annotations","title":"Checking habitat data exported from TransectMeasure","text":"","code":"points <- read_TM(here::here(\"r-workflows/data/raw/\"),                                sample = \"opcode\") ## Rows: 2,483 ## Columns: 32 ## $ filename         <chr> \"10_1_DSC06511.JPG\", \"10_1_DSC06511.JPG\", \"10_1_DSC06… ## $ frame            <chr> \"      0\", \"      0\", \"      0\", \"      0\", \"      0\"… ## $ time_mins        <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N… ## $ image_row        <chr> \"790\", \"986\", \"683\", \"778\", \"976\", \"1009\", \"807\", \"88… ## $ image_col        <chr> \"83\", \"591\", \"930\", \"1829\", \"1654\", \"485\", \"525\", \"83… ## $ date             <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N… ## $ location         <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N… ## $ site             <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N… ## $ transect         <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N… ## $ latitude         <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N… ## $ longitude        <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N… ## $ rugosity         <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N… ## $ depth            <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N… ## $ collector        <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N… ## $ fishing_status   <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N… ## $ campaignid       <chr> \"2023-03_SwC_stereo-BRUVs\", \"2023-03_SwC_stereo-BRUVs… ## $ relief_annotated <chr> \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\",… ## $ sample           <chr> \"10\", \"10\", \"10\", \"10\", \"10\", \"10\", \"10\", \"10\", \"10\",… ## $ period           <chr> \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\"… ## $ frame_info_3     <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N… ## $ frame_info_4     <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N… ## $ frame_info_5     <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N… ## $ frame_info_6     <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N… ## $ level_2          <chr> \"Macroalgae\", \"Seagrasses\", \"Substrate\", \"Macroalgae\"… ## $ level_3          <chr> \"Filamentous / filiform\", \"Strap-like leaves\", \"Uncon… ## $ level_4          <chr> \"Red\", NA, \"Sand / mud (<2mm)\", \"Red\", \"Red\", NA, NA,… ## $ level_5          <chr> NA, NA, \"Coarse sand (with shell fragments)\", NA, NA,… ## $ scientific       <chr> NA, \"Thalassodendron spp\", NA, NA, NA, \"Thalassodendr… ## $ qualifiers       <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N… ## $ caab_code        <chr> \"80300933\", \"63618905\", \"82001014\", \"80300906\", \"8030… ## $ x                <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N… ## $ radius           <chr> \"67.0\", \"24.7\", \"18.2\", \"97.8\", \"82.6\", \"34.1\", \"25.2…"},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/check-habitat.html","id":"filter-the-data-to-only-include-habitat-annotations","dir":"Articles > R-workflows","previous_headings":"Read in the data > Read in the points data exported from Transect Measure, and then filter this into 2 dataframes for relief and habitat annotations","what":"Filter the data to only include habitat annotations","title":"Checking habitat data exported from TransectMeasure","text":"","code":"habitat <- points %>%   dplyr::filter(relief_annotated %in% \"no\") %>%   dplyr::select(campaignid, sample, starts_with(\"level\"), scientific) %>%   glimpse() ## Rows: 1,241 ## Columns: 7 ## $ campaignid <chr> \"2023-03_SwC_stereo-BRUVs\", \"2023-03_SwC_stereo-BRUVs\", \"20… ## $ sample     <chr> \"10\", \"10\", \"10\", \"10\", \"10\", \"10\", \"10\", \"10\", \"10\", \"10\",… ## $ level_2    <chr> \"Macroalgae\", \"Seagrasses\", \"Substrate\", \"Macroalgae\", \"Mac… ## $ level_3    <chr> \"Filamentous / filiform\", \"Strap-like leaves\", \"Unconsolida… ## $ level_4    <chr> \"Red\", NA, \"Sand / mud (<2mm)\", \"Red\", \"Red\", NA, NA, \"Brow… ## $ level_5    <chr> NA, NA, \"Coarse sand (with shell fragments)\", NA, NA, NA, N… ## $ scientific <chr> NA, \"Thalassodendron spp\", NA, NA, NA, \"Thalassodendron spp…"},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/check-habitat.html","id":"filter-the-data-to-only-include-relief-annotations","dir":"Articles > R-workflows","previous_headings":"Read in the data > Read in the points data exported from Transect Measure, and then filter this into 2 dataframes for relief and habitat annotations","what":"Filter the data to only include relief annotations","title":"Checking habitat data exported from TransectMeasure","text":"","code":"relief <- points %>%   dplyr::filter(relief_annotated %in% \"yes\") %>%   dplyr::select(campaignid, sample, starts_with(\"level\"), scientific) %>%   glimpse() ## Rows: 1,242 ## Columns: 7 ## $ campaignid <chr> \"2023-03_SwC_stereo-BRUVs\", \"2023-03_SwC_stereo-BRUVs\", \"20… ## $ sample     <chr> \"10\", \"10\", \"10\", \"10\", \"10\", \"10\", \"10\", \"10\", \"10\", \"10\",… ## $ level_2    <chr> NA, \"Relief\", \"Relief\", \"Relief\", NA, \"Relief\", \"Relief\", \"… ## $ level_3    <chr> NA, \"High\", \"High\", \"High\", NA, \"High\", \"Low / moderate\", \"… ## $ level_4    <chr> NA, \"High (>3m)\", \"High (>3m)\", \"High (>3m)\", NA, \"High (>3… ## $ level_5    <chr> NA, \"3\", \"3\", \"3\", NA, \"3\", \"2\", \"3\", NA, \"3\", \"2\", \"2\", NA… ## $ scientific <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…"},{"path":[]},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/check-habitat.html","id":"set-the-number-of-expected-annotations-to-check-against","dir":"Articles > R-workflows","previous_headings":"Check the data for a variety of errors","what":"Set the number of expected annotations to check against","title":"Checking habitat data exported from TransectMeasure","text":"","code":"num.points <- 20"},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/check-habitat.html","id":"check-if-there-are-habitat-annotations-with-an-unexpected-number-of-annotation-points","dir":"Articles > R-workflows","previous_headings":"Check the data for a variety of errors","what":"Check if there are habitat annotations with an unexpected number of annotation points","title":"Checking habitat data exported from TransectMeasure","text":"","code":"wrong.points.habitat <- habitat %>%   group_by(campaignid, sample) %>%   summarise(points.annotated = n()) %>%   left_join(metadata) %>%   dplyr::mutate(expected = case_when(successful_habitat_forward %in% \"Yes\" & successful_habitat_backward %in% \"Yes\" ~ num.points * 2, successful_habitat_forward %in% \"Yes\" & successful_habitat_backward %in% \"No\" ~ num.points * 1, successful_habitat_forward %in% \"No\" & successful_habitat_backward %in% \"Yes\" ~ num.points * 1, successful_habitat_forward %in% \"No\" & successful_habitat_backward %in% \"No\" ~ num.points * 0)) %>%   dplyr::filter(!points.annotated == expected) %>%   glimpse() ## `summarise()` has grouped output by 'campaignid'. You can override using the ## `.groups` argument. ## Joining with `by = join_by(campaignid, sample)` ## Rows: 5 ## Columns: 14 ## Groups: campaignid [1] ## $ campaignid                  <chr> \"2023-03_SwC_stereo-BRUVs\", \"2023-03_SwC_s… ## $ sample                      <chr> \"21\", \"3\", \"37\", \"45\", \"47\" ## $ points.annotated            <int> 20, 41, 20, 20, 20 ## $ longitude_dd                <chr> \"114.857485\", \"114.9156417\", \"114.9235817\"… ## $ latitude_dd                 <chr> \"-34.06438333\", \"-34.10734167\", \"-34.10853… ## $ date_time                   <chr> \"18/03/2023 2:34\", \"15/03/2023 1:54\", \"15/… ## $ location                    <chr> NA, NA, NA, NA, NA ## $ site                        <chr> NA, NA, NA, NA, NA ## $ depth                       <chr> \"42.3\", \"46.7\", \"46.1\", \"61.9\", \"73\" ## $ successful_count            <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\" ## $ successful_length           <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\" ## $ successful_habitat_forward  <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\" ## $ successful_habitat_backward <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\" ## $ expected                    <dbl> 40, 40, 40, 40, 40"},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/check-habitat.html","id":"check-if-there-are-habitat-annotations-with-an-unexpected-number-of-annotation-points-1","dir":"Articles > R-workflows","previous_headings":"Check the data for a variety of errors","what":"Check if there are habitat annotations with an unexpected number of annotation points","title":"Checking habitat data exported from TransectMeasure","text":"","code":"wrong.points.relief <- relief %>%   group_by(campaignid, sample) %>%   summarise(points.annotated = n()) %>%   left_join(metadata) %>%   dplyr::mutate(expected = case_when(successful_habitat_forward %in% \"Yes\" & successful_habitat_backward %in% \"Yes\" ~ num.points * 2, successful_habitat_forward %in% \"Yes\" & successful_habitat_backward %in% \"No\" ~ num.points * 1, successful_habitat_forward %in% \"No\" & successful_habitat_backward %in% \"Yes\" ~ num.points * 1, successful_habitat_forward %in% \"No\" & successful_habitat_backward %in% \"No\" ~ num.points * 0)) %>%   dplyr::filter(!points.annotated == expected) %>%   glimpse() ## `summarise()` has grouped output by 'campaignid'. You can override using the ## `.groups` argument. ## Joining with `by = join_by(campaignid, sample)` ## Rows: 4 ## Columns: 14 ## Groups: campaignid [1] ## $ campaignid                  <chr> \"2023-03_SwC_stereo-BRUVs\", \"2023-03_SwC_s… ## $ sample                      <chr> \"17\", \"21\", \"23\", \"47\" ## $ points.annotated            <int> 41, 20, 41, 20 ## $ longitude_dd                <chr> \"114.85758\", \"114.857485\", \"114.9189517\", … ## $ latitude_dd                 <chr> \"-34.09634667\", \"-34.06438333\", \"-34.12832… ## $ date_time                   <chr> \"15/03/2023 3:00\", \"18/03/2023 2:34\", \"15/… ## $ location                    <chr> NA, NA, NA, NA ## $ site                        <chr> NA, NA, NA, NA ## $ depth                       <chr> \"43.3\", \"42.3\", \"41\", \"73\" ## $ successful_count            <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\" ## $ successful_length           <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\" ## $ successful_habitat_forward  <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\" ## $ successful_habitat_backward <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\" ## $ expected                    <dbl> 40, 40, 40, 40"},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/check-habitat.html","id":"check-to-see-if-there-are-any-samples-in-habitat-that-dont-have-a-match-in-the-metadata","dir":"Articles > R-workflows","previous_headings":"Check the data for a variety of errors","what":"Check to see if there are any samples in habitat that don’t have a match in the metadata","title":"Checking habitat data exported from TransectMeasure","text":"","code":"habitat.missing.metadata <- anti_join(habitat, metadata, by = c(\"campaignid\", \"sample\")) %>%   glimpse() ## Rows: 40 ## Columns: 7 ## $ campaignid <chr> \"2023-03_SwC_stereo-BRUVs\", \"2023-03_SwC_stereo-BRUVs\", \"20… ## $ sample     <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,… ## $ level_2    <chr> \"Substrate\", \"Substrate\", \"Substrate\", \"Substrate\", \"Substr… ## $ level_3    <chr> \"Unconsolidated (soft)\", \"Unconsolidated (soft)\", \"Unconsol… ## $ level_4    <chr> \"Sand / mud (<2mm)\", \"Sand / mud (<2mm)\", \"Sand / mud (<2mm… ## $ level_5    <chr> \"Coarse sand (with shell fragments)\", \"Coarse sand (with sh… ## $ scientific <chr> NA, NA, NA, NA, NA, NA, NA, NA, \"Thalassodendron spp\", NA, …"},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/check-habitat.html","id":"check-to-see-if-there-are-any-samples-in-the-metadata-that-dont-have-matching-habitat","dir":"Articles > R-workflows","previous_headings":"Check the data for a variety of errors","what":"Check to see if there are any samples in the metadata that don’t have matching habitat","title":"Checking habitat data exported from TransectMeasure","text":"","code":"metadata.missing.habitat <- anti_join(metadata, habitat, by = c(\"campaignid\", \"sample\")) %>%   glimpse() ## Rows: 0 ## Columns: 12 ## $ campaignid                  <chr>  ## $ sample                      <chr>  ## $ longitude_dd                <chr>  ## $ latitude_dd                 <chr>  ## $ date_time                   <chr>  ## $ location                    <chr>  ## $ site                        <chr>  ## $ depth                       <chr>  ## $ successful_count            <chr>  ## $ successful_length           <chr>  ## $ successful_habitat_forward  <chr>  ## $ successful_habitat_backward <chr>"},{"path":[]},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/check-habitat.html","id":"tidy-the-habitat-data-by-joining-with-the-complete-schema-file-that-is-loaded-with-the-checkem-package","dir":"Articles > R-workflows","previous_headings":"Format and save the final tidy dataset","what":"Tidy the habitat data by joining with the complete schema file that is loaded with the CheckEM package","title":"Checking habitat data exported from TransectMeasure","text":"","code":"tidy.habitat <- habitat %>%   dplyr::mutate(number = 1) %>%                                        left_join(catami) %>%   dplyr::select(campaignid, sample, number, starts_with(\"level\"), family, genus, species) %>%   dplyr::filter(!level_2 %in% c(\"\",\"Unscorable\", NA)) %>%     group_by(campaignid, sample, across(starts_with(\"level\")), family, genus, species) %>%   dplyr::tally(number, name = \"number\") %>%   ungroup() %>%                                                        dplyr::select(campaignid, sample, level_1, everything()) %>%   glimpse() ## Joining with `by = join_by(level_2, level_3, level_4, level_5)` ## Warning in left_join(., catami): Detected an unexpected many-to-many relationship between `x` and `y`. ## ℹ Row 23 of `x` matches multiple rows in `y`. ## ℹ Row 193 of `y` matches multiple rows in `x`. ## ℹ If a many-to-many relationship is expected, set `relationship = ##   \"many-to-many\"` to silence this warning. ## Rows: 369 ## Columns: 14 ## $ campaignid <chr> \"2023-03_SwC_stereo-BRUVs\", \"2023-03_SwC_stereo-BRUVs\", \"20… ## $ sample     <chr> \"10\", \"10\", \"10\", \"10\", \"10\", \"10\", \"10\", \"10\", \"12\", \"12\",… ## $ level_1    <chr> \"Biota\", \"Biota\", \"Biota\", \"Biota\", \"Biota\", \"Biota\", \"Biot… ## $ level_2    <chr> \"Macroalgae\", \"Macroalgae\", \"Macroalgae\", \"Macroalgae\", \"Se… ## $ level_3    <chr> \"Erect coarse branching\", \"Erect coarse branching\", \"Erect … ## $ level_4    <chr> \"Brown\", \"Red\", \"Red\", \"Red\", NA, \"Laminar\", \"Simple\", \"San… ## $ level_5    <chr> NA, NA, NA, NA, NA, NA, NA, \"Coarse sand (with shell fragme… ## $ level_6    <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,… ## $ level_7    <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,… ## $ level_8    <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,… ## $ family     <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, \"Le… ## $ genus      <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, \"Ec… ## $ species    <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, \"ra… ## $ number     <dbl> 2, 3, 2, 1, 14, 1, 1, 3, 5, 8, 1, 2, 3, 3, 7, 7, 7, 7, 7, 2…"},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/check-habitat.html","id":"save-the-tidy-habitat-data-as-an-r-data-file","dir":"Articles > R-workflows","previous_headings":"Format and save the final tidy dataset","what":"Save the tidy habitat data as an R data file","title":"Checking habitat data exported from TransectMeasure","text":"","code":"saveRDS(tidy.habitat, file = here::here(paste0(\"r-workflows/data/staging/\", name, \"_habitat.rds\")))"},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/check-habitat.html","id":"tidy-the-relief-data-by-joining-with-the-complete-schema-file-that-is-loaded-with-the-checkem-package","dir":"Articles > R-workflows","previous_headings":"Format and save the final tidy dataset","what":"Tidy the relief data by joining with the complete schema file that is loaded with the CheckEM package","title":"Checking habitat data exported from TransectMeasure","text":"","code":"tidy.relief <- relief %>%   dplyr::select(campaignid, sample, starts_with(\"level\"), scientific) %>%   dplyr::filter(!level_2 %in% c(\"\",\"Unscorable\", NA)) %>%                 dplyr::mutate(number = 1) %>%    left_join(catami) %>%   group_by(campaignid, sample, across(starts_with(\"level\"))) %>%    dplyr::tally(number, name = \"number\") %>%   ungroup() %>%                                                        glimpse() ## Joining with `by = join_by(level_2, level_3, level_4, level_5)` ## Rows: 73 ## Columns: 11 ## $ campaignid <chr> \"2023-03_SwC_stereo-BRUVs\", \"2023-03_SwC_stereo-BRUVs\", \"20… ## $ sample     <chr> \"10\", \"10\", \"10\", \"12\", \"12\", \"14\", \"14\", \"14\", \"15\", \"15\",… ## $ level_2    <chr> \"Relief\", \"Relief\", \"Relief\", \"Relief\", \"Relief\", \"Relief\",… ## $ level_3    <chr> \"High\", \"High\", \"Low / moderate\", \"High\", \"Low / moderate\",… ## $ level_4    <chr> \"High (>3m)\", \"Wall\", \"Moderate (1-3m)\", \"High (>3m)\", \"Mod… ## $ level_5    <chr> \"3\", \"4\", \"2\", \"3\", \"2\", \"3\", \"1\", \"2\", \"3\", \"4\", \"1\", \"2\",… ## $ level_1    <chr> \"Physical\", \"Physical\", \"Physical\", \"Physical\", \"Physical\",… ## $ level_6    <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,… ## $ level_7    <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,… ## $ level_8    <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,… ## $ number     <dbl> 8, 10, 5, 17, 4, 14, 3, 8, 16, 1, 4, 6, 20, 2, 13, 6, 14, 1…"},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/check-habitat.html","id":"save-the-tidy-relief-data-as-an-r-data-file","dir":"Articles > R-workflows","previous_headings":"Format and save the final tidy dataset","what":"Save the tidy relief data as an R data file","title":"Checking habitat data exported from TransectMeasure","text":"","code":"saveRDS(tidy.relief, file = here::here(paste0(\"r-workflows/data/staging/\", name, \"_relief.rds\")))"},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/format-visualise-fish.html","id":"load-species-specific-metrics","dir":"Articles > R-workflows","previous_headings":"","what":"Load species specific metrics","title":"Format & visualise fish data","text":"url <- ‘https://docs.google.com/spreadsheets/d/176genWqd_pc3NDVQtP2CmfMh66Ui6uwWrLoJU1Ny_qw/edit?usp=sharing’ maturity <- googlesheets4::read_sheet(url, sheet = “fisheries Lm”) %>% # dplyr::mutate(scientific = paste(genus, species, sep = ” “)) %>% dplyr::group_by(family, genus, species, sex) %>% dplyr::slice(.min(l50.mm)) %>% ungroup() %>% dplyr::group_by(family, genus, species) %>% dplyr::summarise(l50 = mean(l50.mm)) %>% ungroup() %>% glimpse() tidy.maxn <- readRDS(paste0(“r-workflows/data/staging/”, name, “_complete-maxn.rds”)) %>% dplyr::group_by(campaignid, sample, scientific) %>% dplyr::summarise(maxn = sum(maxn)) %>% pivot_wider(names_from = “scientific”, values_from = maxn, values_fill = 0) %>% dplyr::ungroup() %>% dplyr::mutate(total_abundance = rowSums(.[, 3:(ncol(.))], na.rm = TRUE ), species_richness = rowSums(.[, 3:(ncol(.))] > 0)) %>% dplyr::select(campaignid, sample, total_abundance, species_richness) %>% pivot_longer(cols = c(“total_abundance”, “species_richness”), names_to = “response”, values_to = “number”) %>% dplyr::left_join(habitat) %>% glimpse() saveRDS(tidy.maxn, file = paste0(“r-workflows/data/tidy/”, name, “_tidy-count.rds”)) lengths <- readRDS(paste0(“r-workflows/data/staging/”, name, “_expanded-length.rds”)) %>% dplyr::mutate(depth = .numeric(depth)) %>% # avoid breaking left_join left_join(habitat) %>% left_join(maturity) %>% dplyr::mutate(number = 1) %>% glimpse() indicator.species <- lengths %>% dplyr::mutate(scientific = paste(genus, species, sep = ” “)) %>% dplyr::filter(scientific %% c(”Choerodon rubescens”, “Chrysophrys auratus”, “Glaucosoma hebraicum”)) %>% glimpse() ggplot() + geom_point(data = indicator.species, aes(x = longitude_dd, y = latitude_dd), alpha = 0.5) + coord_sf() metadata.length <- lengths %>% distinct(campaignid, sample, status) %>% glimpse() greater.mat <- indicator.species %>% dplyr::filter(length > l50) %>% dplyr::group_by(campaignid, sample) %>% dplyr::summarise(number = sum(number)) %>% ungroup() %>% right_join(metadata.length) %>% dplyr::mutate(number = ifelse(.na(number), 0, number)) %>% dplyr::mutate(response = “greater Lm”) %>% left_join(habitat) %>% dplyr::glimpse() smaller.mat <- indicator.species %>% dplyr::filter(length < l50) %>% dplyr::group_by(campaignid, sample) %>% dplyr::summarise(number = sum(number)) %>% ungroup() %>% right_join(metadata.length) %>% dplyr::mutate(number = ifelse(.na(number), 0, number)) %>% dplyr::mutate(response = “smaller Lm”) %>% left_join(habitat) %>% dplyr::glimpse() tidy.length <- bind_rows(greater.mat, smaller.mat) %>% glimpse() saveRDS(tidy.length, file = paste0(“r-workflows/data/tidy/”, name, “_tidy-length.rds”))","code":""},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/format-visualise-fish.html","id":"visualise","dir":"Articles > R-workflows","previous_headings":"","what":"Visualise","title":"Format & visualise fish data","text":"sanctuaries <- st_read(“r-workflows/data/spatial/shapefiles/marine-parks-.shp”) %>% st_transform(4326) %>% # Transform match metadata CRS dplyr::filter(str_detect(ZoneName, “Sanctuary|National”))","code":""},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/format-visualise-fish.html","id":"lm-lm","dir":"Articles > R-workflows","previous_headings":"","what":"> Lm & < Lm","title":"Format & visualise fish data","text":"ggplot() + geom_sf(data = sanctuaries, aes(fill = ZoneName), alpha = 0.5) + scale_fill_manual(values = c(“Marine National Park Zone” = “#7bbc63”, “National Park Zone” = “#7bbc63”, “Sanctuary Zone” = “#bfd054”)) + geom_point(data = tidy.lengths, aes(x = longitude_dd, y = latitude_dd, size = number), shape = 1) + coord_sf(xlim = c(min(tidy.lengths\\(longitude_dd), max(tidy.lengths\\)longitude_dd)), ylim = c(min(tidy.lengths\\(latitude_dd), max(tidy.lengths\\)latitude_dd))) + facet_wrap(~scientific)","code":""},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/format-visualise-fish.html","id":"total-abundance","dir":"Articles > R-workflows","previous_headings":"","what":"Total abundance","title":"Format & visualise fish data","text":"ggplot() + geom_sf(data = sanctuaries, aes(fill = ZoneName), alpha = 0.5) + scale_fill_manual(values = c(“Marine National Park Zone” = “#7bbc63”, “National Park Zone” = “#7bbc63”, “Sanctuary Zone” = “#bfd054”)) + geom_point(data = filter(tidy.maxn, response %% “total.abundance”), aes(x = longitude_dd, y = latitude_dd, size = number), shape = 1) + coord_sf(xlim = c(min(tidy.maxn\\(longitude_dd), max(tidy.maxn\\)longitude_dd)), ylim = c(min(tidy.maxn\\(latitude_dd), max(tidy.maxn\\)latitude_dd))) + labs(x = “Longitude”, y = “Latitude”, size = “Total abundance”)","code":""},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/format-visualise-fish.html","id":"species-richness","dir":"Articles > R-workflows","previous_headings":"","what":"Species richness","title":"Format & visualise fish data","text":"ggplot() + geom_sf(data = sanctuaries, aes(fill = ZoneName), alpha = 0.5) + scale_fill_manual(values = c(“Marine National Park Zone” = “#7bbc63”, “National Park Zone” = “#7bbc63”, “Sanctuary Zone” = “#bfd054”)) + geom_point(data = filter(tidy.maxn, response %% “species.richness”), aes(x = longitude_dd, y = latitude_dd, size = number), shape = 1) + coord_sf(xlim = c(min(tidy.maxn\\(longitude_dd), max(tidy.maxn\\)longitude_dd)), ylim = c(min(tidy.maxn\\(latitude_dd), max(tidy.maxn\\)latitude_dd))) + labs(x = “Longitude”, y = “Latitude”, size = “Species richness”)","code":""},{"path":[]},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/spatial-layers.html","id":"load-the-necessary-libraries","dir":"Articles > R-workflows","previous_headings":"R set up","what":"Load the necessary libraries","title":"Generate spatial layers for modelling","text":"","code":"library(sf) library(terra) library(stars) library(starsExtra) library(tidyverse) library(here)"},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/spatial-layers.html","id":"set-the-study-name","dir":"Articles > R-workflows","previous_headings":"R set up","what":"Set the study name","title":"Generate spatial layers for modelling","text":"","code":"name <- 'example-bruv-workflow'"},{"path":[]},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/spatial-layers.html","id":"the-bathymetry-data-used-in-the-example-is-a-relatively-low-spatial-resolution-dataset-downloaded-from-httpsecat-ga-gov-augeonetworksrvengcatalog-searchmetadata148758--feel-free-to-replace-with-any-suitable-bathymetry-in--tif-format-","dir":"Articles > R-workflows","previous_headings":"Load bathymetry data and create bathymetry derivatives","what":"The bathymetry data used in the example is a relatively low spatial resolution dataset downloaded from https://ecat.ga.gov.au/geonetwork/srv/eng/catalog.search#/metadata/148758. Feel free to replace with any suitable bathymetry in .tif format.","title":"Generate spatial layers for modelling","text":"","code":"bathy <- rast(here::here(\"r-workflows/data/spatial/rasters/swc_ga250m.tif\")) %>%   clamp(upper = 0, lower = -250, values = F) %>%   trim()"},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/spatial-layers.html","id":"calculate-terrain-derivatives","dir":"Articles > R-workflows","previous_headings":"Load bathymetry data and create bathymetry derivatives","what":"Calculate terrain derivatives","title":"Generate spatial layers for modelling","text":"","code":"preds <- terrain(bathy, neighbors = 8,                  v = c(\"slope\", \"aspect\", \"TPI\", \"TRI\", \"roughness\"),           # Remove here as necessary                  unit = \"degrees\")"},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/spatial-layers.html","id":"calculate-detrended-bathymetry","dir":"Articles > R-workflows","previous_headings":"Load bathymetry data and create bathymetry derivatives","what":"Calculate detrended bathymetry","title":"Generate spatial layers for modelling","text":"","code":"zstar <- st_as_stars(bathy)                                                     detre <- detrend(zstar, parallel = 8)                                            detre <- as(object = detre, Class = \"SpatRaster\")                                names(detre) <- c(\"detrended\", \"lineartrend\")"},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/spatial-layers.html","id":"join-bathymetry-with-terrain-and-detrended-derivatives","dir":"Articles > R-workflows","previous_headings":"Load bathymetry data and create bathymetry derivatives","what":"Join bathymetry with terrain and detrended derivatives","title":"Generate spatial layers for modelling","text":"","code":"preds <- rast(list(bathy, preds, detre[[1]]))                                    names(preds)[1] <- \"mbdepth\""},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/spatial-layers.html","id":"save-spatial-layers","dir":"Articles > R-workflows","previous_headings":"Load bathymetry data and create bathymetry derivatives","what":"Save spatial-layers","title":"Generate spatial layers for modelling","text":"","code":"preds_w <- wrap(preds) saveRDS(preds_w,            file = here::here(paste0(\"r-workflows/data/spatial/rasters/\",                          name, \"_bathymetry_derivatives.rds\")))"},{"path":[]},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/spatial-layers.html","id":"read-in-the-metadata","dir":"Articles > R-workflows","previous_headings":"Load metadata and extract site-specific derivatives","what":"Read in the metadata","title":"Generate spatial layers for modelling","text":"","code":"metadata <- readRDS(here::here(paste0(\"r-workflows/data/tidy/\",                              name, \"_Metadata.rds\"))) %>%   dplyr::mutate(longitude_dd = as.numeric(longitude_dd),                 latitude_dd = as.numeric(latitude_dd)) %>%   glimpse() ## Rows: 32 ## Columns: 12 ## $ campaignid                  <chr> \"2023-03_SwC_stereo-BRUVs\", \"2023-03_SwC_s… ## $ sample                      <chr> \"35\", \"5\", \"26\", \"23\", \"29\", \"4\", \"32\", \"3… ## $ longitude_dd                <dbl> 114.9236, 114.9292, 114.9284, 114.9190, 11… ## $ latitude_dd                 <dbl> -34.13155, -34.12953, -34.12729, -34.12832… ## $ date_time                   <chr> \"14/03/2023 23:36\", \"14/03/2023 23:49\", \"1… ## $ location                    <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… ## $ site                        <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… ## $ depth                       <chr> \"39.6\", \"42.7\", \"36\", \"41\", \"42.6\", \"45\", … ## $ successful_count            <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", … ## $ successful_length           <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", … ## $ successful_habitat_forward  <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", … ## $ successful_habitat_backward <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", …"},{"path":"https://globalarchivemanual.github.io/CheckEM/articles/r-workflows/spatial-layers.html","id":"convert-the-metadata-to-a-spatial","dir":"Articles > R-workflows","previous_headings":"Load metadata and extract site-specific derivatives","what":"Convert the metadata to a spatial","title":"Generate spatial layers for modelling","text":"","code":"metadata.vect <- vect(metadata, geom = c(\"longitude_dd\", \"latitude_dd\"), crs = \"epsg:4326\") plot(preds[[1]]) plot(metadata.vect, add = T) tidy.metadata_t   <- as.data.frame(metadata.vect, geom = \"XY\") %>%   left_join(metadata) ## Joining with `by = join_by(campaignid, sample, date_time, location, site, ## depth, successful_count, successful_length, successful_habitat_forward, ## successful_habitat_backward)` metadata.bathy.derivatives   <- cbind(tidy.metadata_t,                                       terra::extract(preds, metadata.vect)) %>%   dplyr::filter(!is.na(depth),                                                                   !is.na(roughness)) %>%   glimpse() ## Rows: 32 ## Columns: 22 ## $ campaignid                  <chr> \"2023-03_SwC_stereo-BRUVs\", \"2023-03_SwC_s… ## $ sample                      <chr> \"35\", \"5\", \"26\", \"23\", \"29\", \"4\", \"32\", \"3… ## $ date_time                   <chr> \"14/03/2023 23:36\", \"14/03/2023 23:49\", \"1… ## $ location                    <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… ## $ site                        <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… ## $ depth                       <chr> \"39.6\", \"42.7\", \"36\", \"41\", \"42.6\", \"45\", … ## $ successful_count            <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", … ## $ successful_length           <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", … ## $ successful_habitat_forward  <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", … ## $ successful_habitat_backward <chr> \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", \"Yes\", … ## $ x                           <dbl> 114.9236, 114.9292, 114.9284, 114.9190, 11… ## $ y                           <dbl> -34.13155, -34.12953, -34.12729, -34.12832… ## $ longitude_dd                <dbl> 114.9236, 114.9292, 114.9284, 114.9190, 11… ## $ latitude_dd                 <dbl> -34.13155, -34.12953, -34.12729, -34.12832… ## $ ID                          <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13,… ## $ mbdepth                     <dbl> -34.97151, -36.35807, -40.68553, -38.25594… ## $ slope                       <dbl> 0.146843375, 0.812689749, 0.694289634, 0.4… ## $ aspect                      <dbl> 209.89577, 62.41434, 40.87387, 294.10675, … ## $ TPI                         <dbl> 0.42153454, 2.39535522, -0.67607403, 0.476… ## $ TRI                         <dbl> 0.75557327, 3.29823494, 2.39221191, 1.8367… ## $ roughness                   <dbl> 2.21119308, 8.36493301, 8.36493301, 5.3012… ## $ detrended                   <dbl> -5.6631737, -7.0394716, -11.2637815, -8.69… saveRDS(metadata.bathy.derivatives, here::here(paste0(\"r-workflows/data/tidy/\", name, \"_metadata-bathymetry-derivatives.rds\")))"},{"path":"https://globalarchivemanual.github.io/CheckEM/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Brooke Gibbons. Author, maintainer. Claude Spencer. Author. Tim Langlois. Author. Todd Bond. Contributor. Jacquomo Monk. Contributor. Jordan Goetze. Contributor. . Funder. . Funder.","code":""},{"path":"https://globalarchivemanual.github.io/CheckEM/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Gibbons B, Spencer C, Langlois T (2023). CheckEM: R package Shiny App Formatting, Checking, Visualising Analysing Stereo-Video Annotation Data. R package version 1.0, https://globalarchivemanual.github.io/CheckEM/.","code":"@Manual{,   title = {CheckEM: An R package and Shiny App for Formatting, Checking, Visualising and Analysing Stereo-Video Annotation Data},   author = {Brooke Gibbons and Claude Spencer and Tim Langlois},   year = {2023},   note = {R package version 1.0},   url = {https://globalarchivemanual.github.io/CheckEM/}, }"},{"path":"https://globalarchivemanual.github.io/CheckEM/index.html","id":"checkem","dir":"","previous_headings":"","what":"An R package and Shiny App for Formatting, Checking, Visualising and Analysing Stereo-Video Annotation Data","title":"An R package and Shiny App for Formatting, Checking, Visualising and Analysing Stereo-Video Annotation Data","text":"CheckEM R package shiny app checking, visualizing analysing stereo-video annotation data. idea behind CheckEM provide fish benthic ecologists set tools quickly effectively quality control, format analyse data collected using stereo-video methods. provided: R workflows fish benthic annotation data sets using functions CheckEM. web based app hosted shinyapps.io enable users stereo-video aren’t familiar R quality control format annotations user guide CheckEM shiny app Annotation guides EventMeasure TransectMeasure. hope efforts standardise annotation QC stereo-video data result data meet FAIR principles interoperability reusability.","code":""},{"path":"https://globalarchivemanual.github.io/CheckEM/index.html","id":"to-install-in-r","dir":"","previous_headings":"","what":"To install in R","title":"An R package and Shiny App for Formatting, Checking, Visualising and Analysing Stereo-Video Annotation Data","text":"","code":"install.packages('devtools') library('devtools')  devtools::install_github(\"GlobalArchiveManual/CheckEM\") library(CheckEM)"},{"path":"https://globalarchivemanual.github.io/CheckEM/index.html","id":"checkem-is-available-as-a-shiny-app","dir":"","previous_headings":"","what":"CheckEM is available as a shiny app","title":"An R package and Shiny App for Formatting, Checking, Visualising and Analysing Stereo-Video Annotation Data","text":"CheckEM available web based app hosted shinyapps.io can accessed link can run local version CheckEM (without internet) using R via:","code":"CheckEM::runCheckEM()"},{"path":"https://globalarchivemanual.github.io/CheckEM/reference/clean_names.html","id":null,"dir":"Reference","previous_headings":"","what":"A function to standardise names in a dataframe — clean_names","title":"A function to standardise names in a dataframe — clean_names","text":"function standardise names dataframe","code":""},{"path":"https://globalarchivemanual.github.io/CheckEM/reference/clean_names.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A function to standardise names in a dataframe — clean_names","text":"","code":"clean_names(dat)"},{"path":"https://globalarchivemanual.github.io/CheckEM/reference/clean_names.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A function to standardise names in a dataframe — clean_names","text":"dat","code":""},{"path":"https://globalarchivemanual.github.io/CheckEM/reference/clean_names.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A function to standardise names in a dataframe — clean_names","text":"dataframe lower case names, _ separators","code":""},{"path":"https://globalarchivemanual.github.io/CheckEM/reference/has_special_characters.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to check if a string contains any special characters — has_special_characters","title":"Function to check if a string contains any special characters — has_special_characters","text":"Function check string contains special characters","code":""},{"path":"https://globalarchivemanual.github.io/CheckEM/reference/has_special_characters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to check if a string contains any special characters — has_special_characters","text":"","code":"has_special_characters(string)"},{"path":"https://globalarchivemanual.github.io/CheckEM/reference/has_special_characters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to check if a string contains any special characters — has_special_characters","text":"string","code":""},{"path":"https://globalarchivemanual.github.io/CheckEM/reference/read_TM.html","id":null,"dir":"Reference","previous_headings":"","what":"A function to read .txt exports from SeaGIS TransectMeasure — read_TM","title":"A function to read .txt exports from SeaGIS TransectMeasure — read_TM","text":"function read .txt exports SeaGIS TransectMeasure","code":""},{"path":"https://globalarchivemanual.github.io/CheckEM/reference/read_TM.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A function to read .txt exports from SeaGIS TransectMeasure — read_TM","text":"","code":"read_TM(dir, sample)"},{"path":"https://globalarchivemanual.github.io/CheckEM/reference/read_TM.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A function to read .txt exports from SeaGIS TransectMeasure — read_TM","text":"dir directory .txt files saved sample Either character value define sample recorded \"opcode\" \"period\"","code":""},{"path":"https://globalarchivemanual.github.io/CheckEM/reference/read_TM.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A function to read .txt exports from SeaGIS TransectMeasure — read_TM","text":"dataframe column campaignID sample","code":""},{"path":"https://globalarchivemanual.github.io/CheckEM/reference/read_files_txt.html","id":null,"dir":"Reference","previous_headings":"","what":"Title — read_files_txt","title":"Title — read_files_txt","text":"Title","code":""},{"path":"https://globalarchivemanual.github.io/CheckEM/reference/read_files_txt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title — read_files_txt","text":"","code":"read_files_txt(dir)"},{"path":"https://globalarchivemanual.github.io/CheckEM/reference/read_files_txt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title — read_files_txt","text":"flnm","code":""},{"path":"https://globalarchivemanual.github.io/CheckEM/reference/read_metadata.html","id":null,"dir":"Reference","previous_headings":"","what":"A function to read GlobalArchive format metadata — read_metadata","title":"A function to read GlobalArchive format metadata — read_metadata","text":"function read GlobalArchive format metadata","code":""},{"path":"https://globalarchivemanual.github.io/CheckEM/reference/read_metadata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A function to read GlobalArchive format metadata — read_metadata","text":"","code":"read_metadata(dir)"},{"path":"https://globalarchivemanual.github.io/CheckEM/reference/read_metadata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A function to read GlobalArchive format metadata — read_metadata","text":"dir directory .txt files saved","code":""},{"path":"https://globalarchivemanual.github.io/CheckEM/reference/read_metadata.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A function to read GlobalArchive format metadata — read_metadata","text":"dataframe column campaignID sample","code":""},{"path":"https://globalarchivemanual.github.io/CheckEM/reference/runCheckEM.html","id":null,"dir":"Reference","previous_headings":"","what":"Run CheckEM shiny app locally — runCheckEM","title":"Run CheckEM shiny app locally — runCheckEM","text":"Run CheckEM shiny app locally","code":""},{"path":"https://globalarchivemanual.github.io/CheckEM/reference/runCheckEM.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run CheckEM shiny app locally — runCheckEM","text":"","code":"runCheckEM()"},{"path":"https://globalarchivemanual.github.io/CheckEM/reference/runCheckEM.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run CheckEM shiny app locally — runCheckEM","text":"launch local version CheckEM browser","code":""},{"path":"https://globalarchivemanual.github.io/CheckEM/reference/runCheckEM.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run CheckEM shiny app locally — runCheckEM","text":"","code":"## Not run: if (FALSE) CheckEM::runCheckEM()"},{"path":"https://globalarchivemanual.github.io/CheckEM/reference/standardize_tibble.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to standardize column names and types — standardize_tibble","title":"Function to standardize column names and types — standardize_tibble","text":"Function standardize column names types","code":""},{"path":"https://globalarchivemanual.github.io/CheckEM/reference/standardize_tibble.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to standardize column names and types — standardize_tibble","text":"","code":"standardize_tibble(tibble)"},{"path":"https://globalarchivemanual.github.io/CheckEM/reference/standardize_tibble.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to standardize column names and types — standardize_tibble","text":"tibble","code":""}]
